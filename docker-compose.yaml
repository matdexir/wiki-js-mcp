version: '3.8'

services:
  wiki_js_mcp:
    build: .
    container_name: wiki-js-mcp
    environment:
      - WIKIJS_API_URL=${WIKIJS_API_URL:-http://localhost:3000}
      - WIKIJS_TOKEN=${WIKIJS_TOKEN}
      - WIKIJS_USERNAME=${WIKIJS_USERNAME}
      - WIKIJS_PASSWORD=${WIKIJS_PASSWORD}
      - WIKIJS_MCP_DB=${WIKIJS_MCP_DB:-./wikijs_mappings.db}
      - LOG_LEVEL=${LOG_LEVEL:-INFO}
      - LOG_FILE=${LOG_FILE:-wikijs_mcp.log}
      - REPOSITORY_ROOT=${REPOSITORY_ROOT:-./}
      - DEFAULT_SPACE_NAME=${DEFAULT_SPACE_NAME:-Documentation}
    volumes:
      - ./config:/app/config
      - ./wikijs_mappings.db:/app/wikijs_mappings.db
      - ./logs:/app/logs
    ports:
      - "3001:3001"
    restart: unless-stopped
    networks:
      - wiki-network
    resources:
      limits:
        cpus: '0.5'
        memory: 256M
      reservations:
        cpus: '0.25'
        memory: 128M

networks:
  wiki-network:
    driver: bridge
